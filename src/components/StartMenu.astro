---
// StartMenu.astro - –ú–µ–Ω—é "–ü—É—Å–∫" Windows 98
interface Props {
	isOpen?: boolean;
}

const { isOpen = false } = Astro.props;
---

<div class="win98-start-menu" id="start-menu" style={isOpen ? 'display: block;' : 'display: none;'}>
	<div class="win98-start-menu-header">
		<span>Windows 98</span>
	</div>
	<div class="win98-start-menu-content">
		<!-- –ü—Ä–æ–≥—Ä–∞–º–º—ã -->
		<div class="win98-start-menu-item" data-submenu="programs">
			<span>üìÅ</span>
			<span>–ü—Ä–æ–≥—Ä–∞–º–º—ã</span>
			<span class="win98-menu-arrow">‚ñ∂</span>
		</div>
		
		<!-- –î–æ–∫—É–º–µ–Ω—Ç—ã -->
		<div class="win98-start-menu-item" data-submenu="documents">
			<span>üìÑ</span>
			<span>–î–æ–∫—É–º–µ–Ω—Ç—ã</span>
			<span class="win98-menu-arrow">‚ñ∂</span>
		</div>
		
		<!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
		<div class="win98-start-menu-item" data-submenu="settings">
			<span>‚öôÔ∏è</span>
			<span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
			<span class="win98-menu-arrow">‚ñ∂</span>
		</div>
		
		<!-- –ü–æ–∏—Å–∫ -->
		<div class="win98-start-menu-item" data-action="search">
			<span>üîç</span>
			<span>–ü–æ–∏—Å–∫</span>
		</div>
		
		<!-- –°–ø—Ä–∞–≤–∫–∞ -->
		<div class="win98-start-menu-item" data-action="help">
			<span>‚ùì</span>
			<span>–°–ø—Ä–∞–≤–∫–∞</span>
		</div>
		
		<div class="win98-start-menu-separator"></div>
		
		<!-- –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã -->
		<div class="win98-start-menu-item" data-action="shutdown">
			<span>üö™</span>
			<span>–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã</span>
		</div>
	</div>
	
	<!-- –ü–æ–¥–º–µ–Ω—é "–ü—Ä–æ–≥—Ä–∞–º–º—ã" -->
	<div class="win98-start-menu-submenu" id="programs-submenu">
		<div class="win98-start-menu-submenu-header">
			<span>‚Üê –ü—Ä–æ–≥—Ä–∞–º–º—ã</span>
		</div>
		<div class="win98-start-menu-submenu-content">
			<div class="win98-start-menu-item" data-submenu="games">
				<span>üéÆ</span>
				<span>–ò–≥—Ä—ã</span>
				<span class="win98-menu-arrow">‚ñ∂</span>
			</div>
			<div class="win98-start-menu-item" data-submenu="blog">
				<span>üìù</span>
				<span>–ë–ª–æ–≥</span>
				<span class="win98-menu-arrow">‚ñ∂</span>
			</div>
		</div>
	</div>
	
	<!-- –ü–æ–¥–º–µ–Ω—é "–ò–≥—Ä—ã" -->
	<div class="win98-start-menu-submenu" id="games-submenu">
		<div class="win98-start-menu-submenu-header">
			<span>‚Üê –ò–≥—Ä—ã</span>
		</div>
		<div class="win98-start-menu-submenu-content">
			<div class="win98-start-menu-item" data-action="game" data-game="minesweeper">
				<span>üí£</span>
				<span>–°–∞–ø—ë—Ä</span>
			</div>
			<div class="win98-start-menu-item" data-action="game" data-game="solitaire">
				<span>üÉè</span>
				<span>–ö–æ—Å—ã–Ω–∫–∞</span>
			</div>
			<div class="win98-start-menu-item" data-action="game" data-game="freecell">
				<span>üÇ±</span>
				<span>–ü–∞—Å—å—è–Ω—Å</span>
			</div>
		</div>
	</div>
	
	<!-- –ü–æ–¥–º–µ–Ω—é "–ë–ª–æ–≥" -->
	<div class="win98-start-menu-submenu" id="blog-submenu">
		<div class="win98-start-menu-submenu-header">
			<span>‚Üê –ë–ª–æ–≥</span>
		</div>
		<div class="win98-start-menu-submenu-content">
			<div class="win98-start-menu-item" data-action="navigate" data-url="/blog/">
				<span>üì∞</span>
				<span>–í—Å–µ —Å—Ç–∞—Ç—å–∏</span>
			</div>
			<div class="win98-start-menu-item" data-action="navigate" data-url="/blog/?category=trading">
				<span>üìà</span>
				<span>–¢—Ä–µ–π–¥–∏–Ω–≥</span>
			</div>
			<div class="win98-start-menu-item" data-action="navigate" data-url="/blog/?category=crypto">
				<span>‚Çø</span>
				<span>–ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞</span>
			</div>
			<div class="win98-start-menu-item" data-action="navigate" data-url="/blog/?category=automation">
				<span>ü§ñ</span>
				<span>–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è</span>
			</div>
			<div class="win98-start-menu-item" data-action="navigate" data-url="/blog/?category=strategies">
				<span>üìä</span>
				<span>–°—Ç—Ä–∞—Ç–µ–≥–∏–∏</span>
			</div>
		</div>
	</div>
	
	<!-- –ü–æ–¥–º–µ–Ω—é "–î–æ–∫—É–º–µ–Ω—Ç—ã" -->
	<div class="win98-start-menu-submenu" id="documents-submenu">
		<div class="win98-start-menu-submenu-header">
			<span>‚Üê –î–æ–∫—É–º–µ–Ω—Ç—ã</span>
		</div>
		<div class="win98-start-menu-submenu-content">
			<div class="win98-start-menu-item" data-action="explorer" data-path="articles">
				<span>üìÅ</span>
				<span>–°—Ç–∞—Ç—å–∏</span>
			</div>
			<div class="win98-start-menu-item" data-action="explorer" data-path="archive">
				<span>üì¶</span>
				<span>–ê—Ä—Ö–∏–≤</span>
			</div>
			<div class="win98-start-menu-item" data-action="explorer" data-path="drafts">
				<span>üìù</span>
				<span>–ß–µ—Ä–Ω–æ–≤–∏–∫–∏</span>
			</div>
		</div>
	</div>
</div>

<style>
	/* –ú–µ–Ω—é "–ü—É—Å–∫" */
	.win98-start-menu {
		position: fixed;
		bottom: 30px;
		left: 0;
		width: 200px;
		background: var(--win98-gray-light);
		border: 2px outset var(--win98-gray-light);
		box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
		z-index: 10000;
		display: none;
		font-family: var(--win98-font);
		font-size: 11px;
	}
	
	.win98-start-menu.show {
		display: block;
	}
	
	.win98-start-menu-header {
		background: linear-gradient(to bottom, #000080 0%, #1084D0 100%);
		color: white;
		padding: 4px 8px;
		font-weight: bold;
		font-size: 11px;
	}
	
	.win98-start-menu-content {
		padding: 2px;
	}
	
	.win98-start-menu-item {
		padding: 4px 8px;
		cursor: pointer;
		display: flex;
		align-items: center;
		gap: 8px;
		color: var(--win98-black);
		position: relative;
	}
	
	.win98-start-menu-item:hover {
		background: #000080;
		color: white;
	}
	
	.win98-menu-arrow {
		margin-left: auto;
		font-size: 8px;
	}
	
	.win98-start-menu-separator {
		height: 1px;
		background: var(--win98-bevel-dark);
		border-top: 1px solid var(--win98-bevel-light);
		margin: 2px 0;
	}
	
	/* –ü–æ–¥–º–µ–Ω—é */
	.win98-start-menu-submenu {
		position: fixed;
		bottom: 30px;
		left: 200px;
		width: 200px;
		background: var(--win98-gray-light);
		border: 2px outset var(--win98-gray-light);
		box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
		z-index: 10001;
		display: none;
		font-family: var(--win98-font);
		font-size: 11px;
	}
	
	.win98-start-menu-submenu.show {
		display: block;
	}
	
	.win98-start-menu-submenu-header {
		background: linear-gradient(to bottom, #000080 0%, #1084D0 100%);
		color: white;
		padding: 4px 8px;
		font-weight: bold;
		font-size: 11px;
		cursor: pointer;
	}
	
	.win98-start-menu-submenu-content {
		padding: 2px;
	}
	
	/* –ú–æ–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è */
	@media (max-width: 768px) {
		.win98-start-menu {
			width: 100vw;
			left: 0;
			bottom: 0;
			max-height: 70vh;
			overflow-y: auto;
		}
		
		.win98-start-menu-submenu {
			width: 100vw;
			left: 0;
			bottom: 0;
			max-height: 70vh;
			overflow-y: auto;
		}
		
		.win98-start-menu-item {
			padding: 12px 16px;
			font-size: 14px;
		}
	}
</style>

<script>
	// –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–æ–≤ –≤ –º–µ–Ω—é "–ü—É—Å–∫"
	document.addEventListener('DOMContentLoaded', () => {
		const startMenu = document.getElementById('start-menu');
		if (!startMenu) return;
		
		// –ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –º–µ–Ω—é
		const startButton = document.getElementById('start-button') || document.querySelector('.win98-start-button');
		if (startButton) {
			startButton.addEventListener('click', (e) => {
				e.stopPropagation();
				startMenu.classList.toggle('show');
				hideAllSubmenus();
			});
		}
		
		// –ó–∞–∫—Ä—ã—Ç—å –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
		document.addEventListener('click', (e) => {
			if (!startMenu.contains(e.target) && !startButton?.contains(e.target)) {
				startMenu.classList.remove('show');
				hideAllSubmenus();
			}
		});
		
		// –ü–æ–¥–º–µ–Ω—é
		startMenu.querySelectorAll('[data-submenu]').forEach(item => {
			item.addEventListener('mouseenter', (e) => {
				const submenuId = item.getAttribute('data-submenu') + '-submenu';
				const submenu = document.getElementById(submenuId);
				if (submenu) {
					hideAllSubmenus();
					submenu.classList.add('show');
				}
			});
		});
		
		// –î–µ–π—Å—Ç–≤–∏—è
		startMenu.querySelectorAll('[data-action]').forEach(item => {
			item.addEventListener('click', (e) => {
				const action = item.getAttribute('data-action');
				
				if (action === 'game') {
					const gameId = item.getAttribute('data-game');
					openGame(gameId);
				} else if (action === 'navigate') {
					const url = item.getAttribute('data-url');
					window.location.href = url;
				} else if (action === 'explorer') {
					const path = item.getAttribute('data-path');
					openExplorer(path);
				} else if (action === 'search') {
					openSearch();
				} else if (action === 'help') {
					openHelp();
				} else if (action === 'shutdown') {
					// –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã (–º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –≥–ª–∞–≤–Ω—É—é)
					if (confirm('–ó–∞–≤–µ—Ä—à–∏—Ç—å —Ä–∞–±–æ—Ç—É Windows?')) {
						window.location.href = '/';
					}
				}
				
				startMenu.classList.remove('show');
				hideAllSubmenus();
			});
		});
		
		function hideAllSubmenus() {
			document.querySelectorAll('.win98-start-menu-submenu').forEach(submenu => {
				submenu.classList.remove('show');
			});
		}
		
		function openGame(gameId) {
			// –û—Ç–∫—Ä—ã—Ç—å –∏–≥—Ä—É –≤ –Ω–æ–≤–æ–º –æ–∫–Ω–µ
			const gameWindow = document.createElement('div');
			gameWindow.className = 'win98-window-container active';
			gameWindow.innerHTML = `
				<div class="win98-window">
					<div class="win98-titlebar">
						<span class="win98-titlebar-text">üéÆ ${getGameName(gameId)}</span>
						<div class="win98-titlebar-buttons">
							<div class="win98-button">_</div>
							<div class="win98-button">‚ñ°</div>
							<div class="win98-button win98-button-close" onclick="this.closest('.win98-window-container').remove()">√ó</div>
						</div>
					</div>
					<div class="win98-content">
						<div id="game-container-${gameId}"></div>
					</div>
				</div>
			`;
			document.body.appendChild(gameWindow);
			// –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–≥—Ä—É
			loadGame(gameId);
		}
		
		function getGameName(gameId) {
			const names = {
				minesweeper: '–°–∞–ø—ë—Ä',
				solitaire: '–ö–æ—Å—ã–Ω–∫–∞',
				freecell: '–ü–∞—Å—å—è–Ω—Å',
			};
			return names[gameId] || '–ò–≥—Ä–∞';
		}
		
		function loadGame(gameId) {
			// –ó–∞–≥—Ä—É–∑–∫–∞ –∏–≥—Ä—ã –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–∑–∂–µ
			const container = document.getElementById(`game-container-${gameId}`);
			if (container) {
				container.innerHTML = `<p>–ò–≥—Ä–∞ "${getGameName(gameId)}" –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...</p>`;
			}
		}
		
		function openExplorer(path) {
			// –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ–≤–æ–¥–Ω–∏–∫
			console.log('–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ–≤–æ–¥–Ω–∏–∫:', path);
			// –ë—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø–æ–∑–∂–µ
		}
		
		function openSearch() {
			// –û—Ç–∫—Ä—ã—Ç—å –ø–æ–∏—Å–∫
			console.log('–û—Ç–∫—Ä—ã—Ç—å –ø–æ–∏—Å–∫');
			// –ë—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø–æ–∑–∂–µ
		}
		
		function openHelp() {
			// –û—Ç–∫—Ä—ã—Ç—å —Å–ø—Ä–∞–≤–∫—É
			window.open('/help/', '_blank');
		}
	});
</script>




