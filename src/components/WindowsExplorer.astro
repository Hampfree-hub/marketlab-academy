---
// WindowsExplorer.astro - –ü—Ä–æ–≤–æ–¥–Ω–∏–∫ Windows 98
interface Props {
	path?: string;
	title?: string;
}

const { path = 'articles', title = '–ü—Ä–æ–≤–æ–¥–Ω–∏–∫' } = Astro.props;

// –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫ (–±—É–¥–µ—Ç —Å–≤—è–∑–∞–Ω–∞ —Å —Ä–µ–∞–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –±–ª–æ–≥–∞)
const folderStructure: Record<string, any> = {
	articles: {
		name: '–°—Ç–∞—Ç—å–∏',
		type: 'folder',
		children: {
			trading: {
				name: '–¢—Ä–µ–π–¥–∏–Ω–≥',
				type: 'folder',
				children: {
					'article-1': { name: '–ê–Ω–∞–ª–∏–∑ —Ä—ã–Ω–∫–∞.md', type: 'file', url: '/blog/article-1/' },
					'article-2': { name: 'DCA —Å—Ç—Ä–∞—Ç–µ–≥–∏—è.md', type: 'file', url: '/blog/article-2/' },
				},
			},
			crypto: {
				name: '–ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞',
				type: 'folder',
				children: {
					'article-3': { name: 'Bitcoin ATH.md', type: 'file', url: '/blog/article-3/' },
				},
			},
			automation: {
				name: '–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è',
				type: 'folder',
				children: {
					'article-4': { name: '–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ—Ç–∞.md', type: 'file', url: '/blog/article-4/' },
				},
			},
			strategies: {
				name: '–°—Ç—Ä–∞—Ç–µ–≥–∏–∏',
				type: 'folder',
				children: {
					'article-5': { name: '–¢–æ—Ä–≥–æ–≤–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è.md', type: 'file', url: '/blog/article-5/' },
				},
			},
		},
	},
	archive: {
		name: '–ê—Ä—Ö–∏–≤',
		type: 'folder',
		children: {},
	},
	drafts: {
		name: '–ß–µ—Ä–Ω–æ–≤–∏–∫–∏',
		type: 'folder',
		children: {},
	},
};
---

<div class="win98-window win98-explorer-window" id="explorer-window">
	<div class="win98-titlebar">
		<span class="win98-titlebar-text">üìÅ {title}</span>
		<div class="win98-titlebar-buttons">
			<div class="win98-button">_</div>
			<div class="win98-button">‚ñ°</div>
			<div class="win98-button win98-button-close" onclick="this.closest('.win98-explorer-window').remove()">√ó</div>
		</div>
	</div>
	<div class="win98-content" style="padding: 0;">
		<!-- –ü–∞–Ω–µ–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ -->
		<div class="win98-toolbar">
			<button class="win98-btn" id="explorer-back">‚Üê –ù–∞–∑–∞–¥</button>
			<button class="win98-btn" id="explorer-forward">‚Üí –í–ø–µ—Ä—ë–¥</button>
			<button class="win98-btn" id="explorer-up">‚Üë –í–≤–µ—Ä—Ö</button>
			<div class="win98-separator" style="margin: 0 4px;"></div>
			<button class="win98-btn" id="explorer-folders">üìÅ –ü–∞–ø–∫–∏</button>
		</div>
		
		<!-- –ê–¥—Ä–µ—Å–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ -->
		<div class="win98-address-bar">
			<span style="font-family: var(--win98-font); font-size: 11px; padding: 2px 4px;">–ê–¥—Ä–µ—Å:</span>
			<input type="text" class="win98-input" id="explorer-address" value="C:\–ë–ª–æ–≥\–°—Ç–∞—Ç—å–∏" style="flex: 1; margin: 0 4px;" readonly />
			<button class="win98-btn" style="padding: 2px 8px;">–ü–µ—Ä–µ–π—Ç–∏</button>
		</div>
		
		<!-- –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å -->
		<div class="win98-explorer-layout">
			<!-- –î–µ—Ä–µ–≤–æ –ø–∞–ø–æ–∫ -->
			<div class="win98-explorer-tree" id="explorer-tree">
				<div class="win98-tree-item" data-path="my-computer">
					<span class="win98-tree-icon">üíª</span>
					<span>–ú–æ–π –∫–æ–º–ø—å—é—Ç–µ—Ä</span>
				</div>
				<div class="win98-tree-item expanded" data-path="disk-c">
					<span class="win98-tree-icon">üíø</span>
					<span>–î–∏—Å–∫ C: (–ë–ª–æ–≥)</span>
					<div class="win98-tree-children">
						<div class="win98-tree-item" data-path="articles">
							<span class="win98-tree-icon">üìÅ</span>
							<span>–°—Ç–∞—Ç—å–∏</span>
						</div>
						<div class="win98-tree-item" data-path="archive">
							<span class="win98-tree-icon">üìÅ</span>
							<span>–ê—Ä—Ö–∏–≤</span>
						</div>
						<div class="win98-tree-item" data-path="drafts">
							<span class="win98-tree-icon">üìÅ</span>
							<span>–ß–µ—Ä–Ω–æ–≤–∏–∫–∏</span>
						</div>
					</div>
				</div>
				<div class="win98-tree-item" data-path="disk-d">
					<span class="win98-tree-icon">üíø</span>
					<span>–î–∏—Å–∫ D: (–ò–≥—Ä—ã)</span>
					<div class="win98-tree-children">
						<div class="win98-tree-item" data-path="games">
							<span class="win98-tree-icon">üìÅ</span>
							<span>–ò–≥—Ä—ã</span>
						</div>
					</div>
				</div>
			</div>
			
			<!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–∞–ø–∫–∏ -->
			<div class="win98-explorer-content" id="explorer-content">
				<div class="win98-file-item" data-type="folder" data-path="trading">
					<span class="win98-file-icon">üìÅ</span>
					<span class="win98-file-name">–¢—Ä–µ–π–¥–∏–Ω–≥</span>
				</div>
				<div class="win98-file-item" data-type="folder" data-path="crypto">
					<span class="win98-file-icon">üìÅ</span>
					<span class="win98-file-name">–ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞</span>
				</div>
				<div class="win98-file-item" data-type="folder" data-path="automation">
					<span class="win98-file-icon">üìÅ</span>
					<span class="win98-file-name">–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è</span>
				</div>
				<div class="win98-file-item" data-type="folder" data-path="strategies">
					<span class="win98-file-icon">üìÅ</span>
					<span class="win98-file-name">–°—Ç—Ä–∞—Ç–µ–≥–∏–∏</span>
				</div>
			</div>
		</div>
		
		<!-- –°—Ç—Ä–æ–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è -->
		<div class="win98-status-bar">
			<span id="explorer-status">5 –æ–±—ä–µ–∫—Ç–æ–≤</span>
		</div>
	</div>
</div>

<style>
	.win98-explorer-window {
		width: 800px;
		height: 500px;
		display: flex;
		flex-direction: column;
	}
	
	.win98-toolbar {
		display: flex;
		align-items: center;
		padding: 4px;
		background: var(--win98-gray-light);
		border-bottom: 1px solid var(--win98-bevel-dark);
		gap: 4px;
	}
	
	.win98-address-bar {
		display: flex;
		align-items: center;
		padding: 4px;
		background: var(--win98-white);
		border-bottom: 1px solid var(--win98-bevel-dark);
		gap: 4px;
	}
	
	.win98-explorer-layout {
		display: flex;
		flex: 1;
		overflow: hidden;
	}
	
	.win98-explorer-tree {
		width: 200px;
		border-right: 2px inset var(--win98-gray-light);
		overflow-y: auto;
		padding: 4px;
		background: var(--win98-white);
		font-family: var(--win98-font);
		font-size: 11px;
	}
	
	.win98-tree-item {
		padding: 2px 4px;
		cursor: pointer;
		display: flex;
		align-items: center;
		gap: 4px;
		color: var(--win98-black);
		user-select: none;
	}
	
	.win98-tree-item:hover {
		background: #000080;
		color: white;
	}
	
	.win98-tree-item.expanded > .win98-tree-children {
		display: block;
		margin-left: 16px;
	}
	
	.win98-tree-children {
		display: none;
	}
	
	.win98-tree-icon {
		width: 16px;
		text-align: center;
	}
	
	.win98-explorer-content {
		flex: 1;
		padding: 8px;
		overflow-y: auto;
		display: grid;
		grid-template-columns: repeat(auto-fill, 100px);
		gap: 8px;
		align-content: start;
		background: var(--win98-white);
	}
	
	.win98-file-item {
		display: flex;
		flex-direction: column;
		align-items: center;
		padding: 8px;
		cursor: pointer;
		border: 1px solid transparent;
		text-align: center;
	}
	
	.win98-file-item:hover {
		background: rgba(0, 0, 128, 0.1);
		border: 1px dotted var(--win98-blue);
	}
	
	.win98-file-item.selected {
		background: rgba(0, 0, 128, 0.2);
		border: 1px solid var(--win98-blue);
	}
	
	.win98-file-icon {
		font-size: 32px;
		margin-bottom: 4px;
	}
	
	.win98-file-name {
		font-family: var(--win98-font);
		font-size: 11px;
		color: var(--win98-black);
		word-break: break-word;
		max-width: 100px;
	}
	
	.win98-status-bar {
		padding: 2px 4px;
		background: var(--win98-gray-light);
		border-top: 1px solid var(--win98-bevel-dark);
		font-family: var(--win98-font);
		font-size: 11px;
		color: var(--win98-black);
	}
	
	/* –ú–æ–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è */
	@media (max-width: 768px) {
		.win98-explorer-window {
			width: 95vw;
			height: 70vh;
		}
		
		.win98-explorer-layout {
			flex-direction: column;
		}
		
		.win98-explorer-tree {
			width: 100%;
			height: 150px;
			border-right: none;
			border-bottom: 2px inset var(--win98-gray-light);
		}
		
		.win98-explorer-content {
			grid-template-columns: repeat(auto-fill, 80px);
			gap: 8px;
		}
		
		.win98-file-item {
			padding: 6px;
		}
		
		.win98-file-icon {
			font-size: 24px;
		}
		
		.win98-file-name {
			font-size: 10px;
			max-width: 80px;
		}
	}
</style>

<script>
	// –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–æ–¥–Ω–∏–∫–∞
	document.addEventListener('DOMContentLoaded', () => {
		const explorerContent = document.getElementById('explorer-content');
		const explorerTree = document.getElementById('explorer-tree');
		const explorerAddress = document.getElementById('explorer-address');
		
		if (!explorerContent || !explorerTree) return;
		
		// –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–æ–≤ –ø–æ —Ñ–∞–π–ª–∞–º/–ø–∞–ø–∫–∞–º
		explorerContent.addEventListener('click', (e) => {
			const fileItem = e.target.closest('.win98-file-item');
			if (!fileItem) return;
			
			const type = fileItem.getAttribute('data-type');
			const path = fileItem.getAttribute('data-path');
			
			if (type === 'folder') {
				// –û—Ç–∫—Ä—ã—Ç—å –ø–∞–ø–∫—É
				openFolder(path);
			} else if (type === 'file') {
				// –û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª (—Å—Ç–∞—Ç—å—é)
				const url = fileItem.getAttribute('data-url');
				if (url) {
					window.location.href = url;
				}
			}
		});
		
		// –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–≤–æ–π–Ω–æ–≥–æ –∫–ª–∏–∫–∞
		explorerContent.addEventListener('dblclick', (e) => {
			const fileItem = e.target.closest('.win98-file-item');
			if (!fileItem) return;
			
			const type = fileItem.getAttribute('data-type');
			const path = fileItem.getAttribute('data-path');
			
			if (type === 'folder') {
				openFolder(path);
			} else if (type === 'file') {
				const url = fileItem.getAttribute('data-url');
				if (url) {
					window.location.href = url;
				}
			}
		});
		
		// –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–æ–≤ –ø–æ –¥–µ—Ä–µ–≤—É
		explorerTree.addEventListener('click', (e) => {
			const treeItem = e.target.closest('.win98-tree-item');
			if (!treeItem) return;
			
			const path = treeItem.getAttribute('data-path');
			if (path) {
				// –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å expanded
				if (treeItem.querySelector('.win98-tree-children')) {
					treeItem.classList.toggle('expanded');
				}
				// –û—Ç–∫—Ä—ã—Ç—å –ø–∞–ø–∫—É
				openFolder(path);
			}
		});
		
		function openFolder(path: string) {
			// –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–∞–ø–∫–∏
			// –≠—Ç–æ –±—É–¥–µ—Ç —Å–≤—è–∑–∞–Ω–æ —Å —Ä–µ–∞–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –±–ª–æ–≥–∞
			console.log('–û—Ç–∫—Ä—ã—Ç—å –ø–∞–ø–∫—É:', path);
			
			// –û–±–Ω–æ–≤–∏—Ç—å –∞–¥—Ä–µ—Å–Ω—É—é —Å—Ç—Ä–æ–∫—É
			if (explorerAddress) {
				explorerAddress.value = `C:\\–ë–ª–æ–≥\\${path}`;
			}
			
			// –û–±–Ω–æ–≤–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ (–∑–∞–≥–ª—É—à–∫–∞)
			if (explorerContent) {
				explorerContent.innerHTML = `
					<div class="win98-file-item" data-type="file" data-url="/blog/article-1/">
						<span class="win98-file-icon">üìÑ</span>
						<span class="win98-file-name">–°—Ç–∞—Ç—å—è 1.md</span>
					</div>
					<div class="win98-file-item" data-type="file" data-url="/blog/article-2/">
						<span class="win98-file-icon">üìÑ</span>
						<span class="win98-file-name">–°—Ç–∞—Ç—å—è 2.md</span>
					</div>
				`;
			}
		}
		
		// –ö–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
		document.getElementById('explorer-back')?.addEventListener('click', () => {
			console.log('–ù–∞–∑–∞–¥');
		});
		
		document.getElementById('explorer-forward')?.addEventListener('click', () => {
			console.log('–í–ø–µ—Ä—ë–¥');
		});
		
		document.getElementById('explorer-up')?.addEventListener('click', () => {
			console.log('–í–≤–µ—Ä—Ö');
		});
	});
</script>




