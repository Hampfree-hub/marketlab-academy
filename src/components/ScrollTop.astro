---
/* 
  ScrollTop Component
  Authentic 8-bit style button to scroll back to top.
  Pixel-perfect SVG arrow.
*/
import { getLangFromUrl, useTranslations } from '../i18n/utils';
const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---

<button id="scrollTop" class="scroll-top" aria-label={t('scroll_top.label')}>
	<svg viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
		<!-- Pixel Perfect NES Arrow - using rectangles -->
		<rect x="7" y="2" width="2" height="1"/>
		<rect x="6" y="3" width="4" height="1"/>
		<rect x="5" y="4" width="6" height="1"/>
		<rect x="4" y="5" width="8" height="1"/>
		<rect x="3" y="6" width="10" height="1"/>
		<rect x="2" y="7" width="12" height="1"/>
		<rect x="7" y="8" width="2" height="6"/>
	</svg>
</button>

<script is:inline>
	const initScrollTop = () => {
		const btn = document.getElementById('scrollTop');
		if (!btn) return;

		const checkScroll = () => {
			if (window.pageYOffset > 400) {
				btn.classList.add('visible');
			} else {
				btn.classList.remove('visible');
			}
		};

		window.addEventListener('scroll', checkScroll, { passive: true });

		btn.onclick = () => {
			window.scrollTo({ top: 0, behavior: 'auto' });
		};
	};

	if (document.readyState === 'loading') {
		document.addEventListener('DOMContentLoaded', initScrollTop);
	} else {
		initScrollTop();
	}
</script>

<style>
	.scroll-top {
		position: fixed;
		bottom: 32px;
		right: 32px;
		background: var(--nes-bg-secondary);
		border: 4px solid var(--nes-border-primary);
		color: var(--nes-accent-green);
		width: 48px;
		height: 48px;
		display: none;
		align-items: center;
		justify-content: center;
		cursor: pointer;
		z-index: 1000;
		padding: 8px;
		transition: none;
	}

	.scroll-top.visible {
		display: flex;
	}

	.scroll-top svg {
		width: 100%;
		height: 100%;
		image-rendering: pixelated;
		shape-rendering: crispedges;
	}

	.scroll-top:hover {
		background: var(--nes-accent-green);
		color: #FFFFFF;
		border-color: var(--nes-accent-green);
		border-bottom-color: var(--nes-accent-green-dark);
	}

	.scroll-top:active {
		border-bottom-width: 2px;
		transform: translateY(2px);
	}

	@media (max-width: 768px) {
		.scroll-top {
			bottom: 16px;
			right: 16px;
			width: 28px;
			height: 28px;
			padding: 4px;
		}
	}
</style>
