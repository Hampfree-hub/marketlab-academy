---
---
<button id="theme-toggle" class="theme-btn" aria-label="Переключить тему">
	<svg class="theme-icon" viewBox="0 0 16 16" fill="currentColor">
		<!-- Sun icon (8-bit pixel) -->
		<rect x="6" y="0" width="4" height="2"/>
		<rect x="6" y="14" width="4" height="2"/>
		<rect x="0" y="6" width="2" height="4"/>
		<rect x="14" y="6" width="2" height="4"/>
		<rect x="4" y="4" width="8" height="8"/>
	</svg>
</button>

<script is:inline>
	// Theme Toggle logic (shared between desktop and mobile)
	const themeToggle = () => {
		const getTheme = () => localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark');
		
		const sunIcon = `<rect x="6" y="0" width="4" height="2"/><rect x="6" y="14" width="4" height="2"/><rect x="0" y="6" width="2" height="4"/><rect x="14" y="6" width="2" height="4"/><rect x="4" y="4" width="8" height="8"/>`;
		const moonIcon = `<rect x="4" y="2" width="2" height="2"/><rect x="4" y="12" width="2" height="2"/><rect x="6" y="4" width="2" height="8"/><rect x="8" y="2" width="2" height="2"/><rect x="8" y="12" width="2" height="2"/><rect x="10" y="4" width="2" height="2"/><rect x="10" y="10" width="2" height="2"/><rect x="12" y="6" width="2" height="4"/>`;
		
		const setTheme = (t) => {
			document.documentElement.setAttribute('data-theme', t);
			localStorage.setItem('theme', t);
			const icons = document.querySelectorAll('.theme-icon, .theme-icon-mobile');
			icons.forEach(i => i.innerHTML = t === 'dark' ? sunIcon : moonIcon);
		};

		setTheme(getTheme());

		// Desktop theme button
		const btn = document.getElementById('theme-toggle');
		if (btn) {
			btn.addEventListener('click', () => {
				const next = document.documentElement.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
				setTheme(next);
			});
		}

		// Mobile theme button
		const btnMobile = document.getElementById('theme-toggle-mobile');
		if (btnMobile) {
			btnMobile.addEventListener('click', () => {
				const next = document.documentElement.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
				setTheme(next);
			});
		}
	};
	
	// Initialize only once
	if (!window.themeToggleInitialized) {
		themeToggle();
		window.themeToggleInitialized = true;
	}
</script>

<style>
	.theme-btn {
		background: transparent;
		border: 2px solid var(--nes-border-primary);
		border-bottom: 4px solid var(--nes-border-primary);
		color: var(--color-text-primary);
		padding: 6px;
		cursor: pointer;
		font-family: 'Press Start 2P', monospace;
		display: flex;
		align-items: center;
		justify-content: center;
		min-width: 28px;
		min-height: 28px;
		width: 28px;
		height: 28px;
		transition: border-color 0.10s steps(3),
		            background 0.10s steps(3),
		            color 0.10s steps(3);
	}

	.theme-btn:hover {
		border-color: var(--nes-accent-green);
		border-bottom-color: var(--nes-accent-green-dark);
		background: var(--nes-accent-green);
		color: #FFFFFF;
		text-decoration: none !important;
	}

	.theme-icon {
		width: 14px;
		height: 14px;
		display: block;
	}

	/* Tablet and Desktop */
	@media (min-width: 769px) {
		.theme-btn {
			min-width: 32px;
			min-height: 32px;
			width: 32px;
			height: 32px;
			padding: 8px;
		}
		.theme-icon {
			width: 16px;
			height: 16px;
		}
	}
</style>
